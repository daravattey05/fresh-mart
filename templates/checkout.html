{% extends 'base.html' %}
{% load static %}

{% block hero %}
<!-- Hero & Breadcrumb Section Begin -->
<section class="breadcrumb-section set-bg" data-setbg="{% static 'img/breadcrumb.jpg' %}">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 text-center">
                <div class="breadcrumb__text">
                    <h2>Checkout</h2>
                    <div class="breadcrumb__option">
                        <a href="{% url 'core:index' %}">Home</a>
                        <a href="{% url 'core:view_cart' %}">Cart</a>
                        <span>Checkout</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Breadcrumb Section End -->
{% endblock %}

{% block content %}
<!-- Checkout Section Begin -->
<section class="checkout spad">
    <div class="container">
        <div class="checkout__form">
            <h4>Billing Details & Payment</h4>
            <form action="{% url 'core:checkout' %}" method="POST">
                {% csrf_token %}
                <div class="row">
                    <div class="col-lg-8 col-md-6">
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="checkout__input">
                                    <p>Full Name<span>*</span></p>
                                    <input type="text" name="full_name" value="{{ user.get_full_name }}" required>
                                </div>
                            </div>
                        </div>
                        <div class="checkout__input">
                            <p>Phone<span>*</span></p>
                            <input type="text" name="phone" required>
                        </div>
                        <div class="checkout__input">
                            <p>Address<span>*</span></p>
                            <input type="text" name="address" placeholder="Street Address" required>
                        </div>
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="checkout__input">
                                    <p>Town/City<span>*</span></p>
                                    <input type="text" name="city" required>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="checkout__input">
                                    <p>Province<span>*</span></p>
                                    <input type="text" name="province" required>
                                </div>
                            </div>
                        </div>
                        <div class="checkout__input">
                            <p>Order Notes (Optional)</p>
                            <input type="text" name="notes"
                                placeholder="Notes about your order, e.g. special notes for delivery.">
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="checkout__order">
                            <h4>Your Order</h4>
                            <div class="checkout__order__products">Products <span>Total</span></div>
                            <ul>
                                {% for item in order_items %}
                                <li>{{ item.product.name }} (x{{ item.quantity}})
                                    <span>${{ item.get_total_price|floatformat:2 }}</span>
                                </li>
                                {% endfor %}
                            </ul>
                            <div class="checkout__order__subtotal">Subtotal <span>${{ order.total_price|floatformat:2|default:"0.00" }}</span></div>
                            <div class="checkout__order__total">Total <span>${{ order.total_price|floatformat:2|default:"0.00" }}</span></div>

                            <div class="checkout__input__checkbox">
                                <label for="khqr-payment">
                                    <input type="radio" name="payment_method" id="khqr-payment" value="khqr" checked>
                                    KHQR Payment (Recommended)
                                    <span class="checkmark"></span>
                                </label>
                                <p style="margin-left: 30px; font-size: 13px; color: #666;">
                                    Scan QR code to pay with any Cambodian banking app
                                </p>
                            </div>

                            <div class="checkout__input__checkbox">
                                <label for="cash-payment">
                                    <input type="radio" name="payment_method" id="cash-payment" value="cash">
                                    Cash on Delivery
                                    <span class="checkmark"></span>
                                </label>
                            </div>

                            <button type="submit" class="site-btn">PLACE ORDER</button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</section>
<!-- Checkout Section End -->
{% endblock %}